upgma unweighted pair group method arithmetic mean simple agglomerative bottomup hierarchical clustering method also weighted variant wpgma generally attributed sokal note unweighted term indicates distances contribute equally average computed refer math achieved thus simple averaging wpgma produces weighted result proportional averaging upgma produces unweighted result see working upgma algorithm constructs rooted tree dendrogram reflects structure present pairwise similarity matrix dissimilarity matrix step nearest two clusters combined higherlevel cluster distance two clusters displaystyle mathcal b displaystyle mathcal b size ie cardinality displaystyle mathcal b displaystyle mathcal b taken average distances x displaystyle dxy pairs objects x displaystyle x displaystyle mathcal displaystyle b displaystyle mathcal b mean distance elements cluster words clustering step updated distance joined clusters b displaystyle mathcal acup mathcal b new cluster x displaystyle x given proportional averaging x displaystyle dmathcal ax b x displaystyle dmathcal bx distances b x x b b x b displaystyle dmathcal acup mathcal bxfrac mathcal acdot dmathcal axmathcal bcdot dmathcal bxmathcal amathcal b upgma algorithm produces rooted dendrograms requires constantrate assumption assumes ultrametric tree distances root every branch tip equal tips molecular data ie dna rna protein sampled time ultrametricity assumption becomes equivalent assuming molecular clock working example based genetic distance matrix computed ribosomal rna sequence alignment five bacteria bacillus subtilis displaystyle bacillus stearothermophilus b displaystyle b lactobacillus viridescens c displaystyle c acholeplasma modicum displaystyle micrococcus luteus e displaystyle e let us assume five elements b c e displaystyle abcde following matrix displaystyle pairwise distances example b displaystyle smallest value displaystyle join elements displaystyle b displaystyle b let u displaystyle u denote node displaystyle b displaystyle b connected setting δ u δ b u b displaystyle delta audelta ensures elements displaystyle b displaystyle b equidistant u displaystyle u corresponds expectation ultrametricity hypothesis branches joining displaystyle b displaystyle b u displaystyle u lengths δ u δ b u displaystyle delta audelta see final dendrogram proceed update initial distance matrix displaystyle new distance matrix displaystyle see reduced size one row one column clustering displaystyle b displaystyle b bold values displaystyle correspond new distances calculated averaging distances element first cluster b displaystyle ab remaining elements b c c b c displaystyle b b displaystyle b e e b e displaystyle italicized values displaystyle affected matrix update correspond distances elements involved first cluster reiterate three previous steps starting new distance matrix displaystyle b e displaystyle smallest value displaystyle join cluster b displaystyle ab element e displaystyle e let v displaystyle v denote node b displaystyle ab e displaystyle e connected ultrametricity constraint branches joining displaystyle b displaystyle b v displaystyle v e displaystyle e v displaystyle v equal following length δ v δ b v δ e v displaystyle delta avdelta bvdelta deduce missing branch length δ u v δ e v δ u δ e v δ b u displaystyle delta uvdelta evdelta audelta evdelta see final dendrogram proceed update displaystyle new distance matrix displaystyle see reduced size one row one column clustering b displaystyle ab e displaystyle e bold values displaystyle correspond new distances calculated proportional averaging b e c b c e c displaystyle thanks proportional average calculation new distance accounts larger size b displaystyle ab cluster two elements respect e displaystyle e one element similarly b e b e displaystyle proportional averaging therefore gives equal weight initial distances matrix displaystyle reason method unweighted respect mathematical procedure respect initial distances reiterate three previous steps starting updated distance matrix displaystyle c displaystyle smallest value displaystyle join elements c displaystyle c displaystyle let w displaystyle w denote node c displaystyle c displaystyle connected branches joining c displaystyle c displaystyle w displaystyle w lengths δ c w δ w displaystyle delta cwdelta see final dendrogram single entry update keeping mind two elements c displaystyle c displaystyle contribution displaystyle average computation c b e c b e b e displaystyle final displaystyle matrix join clusters b e displaystyle abe c displaystyle cd let r displaystyle r denote root node b e displaystyle abe c displaystyle cd connected branches joining b e displaystyle abe c displaystyle cd r displaystyle r lengths δ b e r δ c r displaystyle delta aberdelta deduce two remaining branch lengths δ v r δ b e r δ e v displaystyle delta vrdelta aberdelta δ w r δ c r δ c w displaystyle delta wrdelta cdrdelta dendrogram ultrametric tips displaystyle e displaystyle e equidistant r displaystyle r δ r δ b r δ e r δ c r δ r displaystyle delta ardelta brdelta erdelta crdelta dendrogram therefore rooted r displaystyle r deepest node alternative linkage schemes include single linkage clustering complete linkage clustering wpgma average linkage clustering implementing different linkage simply matter using different formula calculate intercluster distances distance matrix update steps algorithm complete linkage clustering avoids drawback alternative single linkage clustering method socalled chaining phenomenon clusters formed via single linkage clustering may forced together due single elements close even though many elements cluster may distant complete linkage tends find compact clusters approximately equal trivial implementation algorithm construct upgma tree n displaystyle time complexity using heap cluster keep distances cluster reduces time n log n displaystyle n fionn murtagh presented n displaystyle time space httpsenwikipediaorgwikiupgma