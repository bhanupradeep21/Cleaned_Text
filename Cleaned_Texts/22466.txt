probalign sequence alignment tool calculates maximum expected accuracy alignment using partition function posterior base pair probabilities estimated using estimate similar boltzmann distribution partition function calculated using dynamic programming approach following describes algorithm used probalign determine base pair score alignment two sequences two things needed score displaystyle sa alignment defined x j σ x j gap cost displaystyle sasum xiyjin asigma xiyjtextgap cost boltzmann weighted score alignment e e x j σ x j gap cost x e σ x j e g p c displaystyle efrac satefrac sum xiyjin asigma xiyjtextgap costtleftprod xiyiin aefrac sigma xiyjtrightcdot efrac gapcostt displaystyle scaling factor probability alignment assuming boltzmann distribution given p r x e z displaystyle praxyfrac efrac satz z displaystyle z partition function ie sum boltzmann weights alignments let z j displaystyle zij denote partition function prefixes x x x displaystyle j displaystyle three different cases considered z j z j z j z j displaystyle zijzijmzijdziji matrixes initialized follows partition function alignments two sequences x displaystyle x displaystyle given z x displaystyle zxy recursively computed finally probability positions x displaystyle xi j displaystyle yj form base pair given p x j x z j e σ x j z j z x displaystyle pxiyjxyfrac efrac sigma xiyjtcdot zijzxy z j displaystyle zij respective values recalculated z displaystyle z inversed base pair strings httpsenwikipediaorgwikiprobalign