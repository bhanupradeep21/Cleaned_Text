hydrogeosphere hgs controlvolume finite element groundwater model based rigorous conceptualization hydrologic system consisting surface subsurface flow model designed take account key components hydrologic cycle time step model solves surface subsurface flow solute energy transport equations simultaneously provides complete water solute balance original name code created rené therrien code developed jointly university waterloo laval university primarily used academic research renamed hydrogeosphere implementation surface water flow software became commercialized support management aquanty inc order accomplish integrated analysis hydrogeosphere utilizes rigorous mass conservative modeling approach fully couples surface flow transport equations variably saturated subsurface flow transport equations approach significantly robust previous conjunctive approaches rely linkage separate surface subsurface modeling codes hydrogeosphere assumes subsurface flow equation porous medium always solved simulation either fully saturated variably saturated flow conditions subsurface flow equation expanded incorporate discrete fractures second interacting porous continuum wells tile drains surface flow following assumptions made subsurface flow richards equation used describe threedimensional transient subsurface flow variably saturated porous medium fluid flux q displaystyle textbf q represented darcys law shown w displaystyle wm volumetric fraction total porosity occupied porous medium γ e x displaystyle gamma ex internal fluid exchange rate eg surface water wells tile drains q displaystyle q external fluid outside model domain θ displaystyle theta saturated water content w displaystyle sw degree saturation k displaystyle textbf k hydraulic conductivity tensor k r displaystyle kr relative permeability medium calculated function saturation ψ displaystyle psi pressure head z displaystyle z elevation head areal surface water flow represented hydrogeosphere twodimensional depthaveraged flow equation diffusionwave approximation saint venant equation surface water flow hydrogeospheres surface water flow component implemented following assumptions surface flow components solved following three equations given following mass balance equation coupled momentum equations neglecting inertia terms xdirection ydirection ϕ displaystyle phi surface flow domain porosity h displaystyle ho water surface elevation v x displaystyle bar vxo v displaystyle bar vyo vertically averaged flow velocities x directions displaystyle depth surface water flow γ displaystyle gamma internal fluid exchange q displaystyle qo external fluid exchange surface conductances k x displaystyle kox k displaystyle koy approximated either manning chezy equation threedimensional transport solutes described modified reactive transport advectivedispersion equation w q c θ w c w θ w r λ c p r ω e x q c w θ w r c θ w r λ c displaystyle nabla cdot wmtextbf qctheta sswtextbf dnabla cwmtheta sswrlambda cparsum omega exqcwmleftfrac partial theta sswrcpartial ttheta sswrlambda cright c displaystyle c solute concentration λ displaystyle lambda firstorder decay constant q c displaystyle qc external source sink term ω displaystyle omega internal solute transfer domains r displaystyle r retardation factor displaystyle textbf diffusion coefficient p r displaystyle par designates parent species case decay chain graf incorporated heat transport within saturatedzone flow regime hydrogeosphere together temperaturedependent fluid properties viscosity density model capability successfully demonstrated case thermohaline flow transport porous fractured porous media graf therrien work extends model capability include thermal energy transport unsaturated zone surface water considered key step linkage atmospheric hydrologic systems surface heat fluxes atmospheric inputs important sourcesink thermal energy especially surface water system surface heat fluxes across land surface also incorporated hydrogeosphere complete description physical processes governing flow solute transport equations form basis hydrogeosphere found therrien et al therefore presented general equation variably saturated subsurface thermal energy transport following molson et al given q ρ w c w k b c b ρ b ω q ρ b c b displaystyle nabla cdot big textbf qrho wcwtkbcbrho btextbf dnabla tbig omega opm qtfrac partial rho bcbtpartial ρ displaystyle rho density c displaystyle c heat capacity displaystyle temperature bulk subsurface k displaystyle k thermal conductivity displaystyle thermal dispersion term q displaystyle qt thermal sourcesink ω displaystyle omega thermal interactions surface subsurface q displaystyle qt external thermal interactions areal surface flow modules hydrogeosphere follow conventions spatial temporal discretizations used subsurface modules surface flow equation solved finiteelement mesh stacked upon subsurface grid solving domains ie x ylocations nodes layer nodes superposition grid generated subsurface domain mirrored areally surface flow nodes surface flow node elevations corresponding top elevation topmost active layer subsurface grid note surface flow node elevations may vary substantially conform topography however assumptions small slope inherent diffusionwave equation allow modeling inertial effects discretized surface equation coupled subsurface flow equation via superposition common node approach via leakage surficial skin layer dual node approach approaches fully implicit coupling surface subsurface flow regimes provides integral view movement water opposed traditional division surface subsurface regimes flux across land surface therefore natural internal process allowing water move surface subsurface flow systems governed local flow hydrodynamics instead using physically artificial boundary conditions interface subsurface connection provided via superposition hydrogeosphere adds surface flow equation terms surface mesh top layer subsurface nodes case fluid exchange flux contains leakance term need explicitly defined hgs model threedimensional controlvolume finite element simulator designed simulate entire terrestrial portion hydrologic cycle uses globally implicit approach simultaneously solve diffusivewave equation form richards equation hgs also dynamically integrates key components hydrologic cycle evaporation bare soil water bodies vegetationdependent transpiration root uptake snowmelt soil freezethaw features macro pores fractures tile drains either incorporated discretely using dualporosity dual permeability formulation additionally hydrogeosphere linked weather research forecasting mesoscale atmospheric model fully coupled subsurface surface atmospheric httpsenwikipediaorgwikihydrogeosphere