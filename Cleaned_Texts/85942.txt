biology substitution model also called models dna sequence evolution markov models describe changes evolutionary models describe evolutionary changes macromolecules eg dna sequences represented sequence symbols c g case dna substitution models used calculate likelihood phylogenetic trees using multiple sequence alignment data thus substitution models central maximum likelihood estimation phylogeny well bayesian inference phylogeny estimates evolutionary distances numbers substitutions occurred since pair sequences diverged common ancestor typically calculated using substitution models evolutionary distances used input distance methods neighbor joining substitution models also central phylogenetic invariants necessary predict site pattern frequencies given tree substitution models also necessary simulate sequence data group organisms related specific tree phylogenetic tree topologies often parameter thus branch lengths parameters describing substitution process often viewed nuisance parameters however biologists sometimes interested aspects model example branch lengths especially branch lengths combined information fossil record model estimate timeframe model parameters used gain insights various aspects process evolution kaks ratio also called ω codon substitution models parameter interest many studies kaks ratio used examine action natural selection proteincoding provides information relative rates nucleotide substitutions change amino acids nonsynonymous substitutions change encoded amino acid synonymous substitutions work substitution models focused dnarna protein sequence evolution models dna sequence evolution alphabet corresponds four nucleotides c g probably easiest models understand dna models also used examine rna virus evolution reflects fact rna also four nucleotide alphabet c g u however substitution models used alphabets size alphabet proteinogenic amino acids proteins sense codons ie codons encode amino acids standard genetic code aligned proteincoding gene sequences fact substitution models developed biological characters encoded using specific alphabet eg amino acid sequences combined information conformation amino acids threedimensional protein majority substitution models used evolutionary research assume independence among sites ie probability observing specific site pattern identical regardless site pattern sequence alignment simplifies likelihood calculations necessary calculate probability site patterns appear alignment use values calculate overall likelihood alignment eg probability three gggg site patterns given model dna sequence evolution simply probability single gggg site pattern raised third power means substitution models viewed implying specific multinomial distribution site pattern frequencies consider multiple sequence alignment four dna sequences possible site patterns degrees freedom site pattern frequencies however possible specify expected site pattern frequencies using five degrees freedom using jukescantor model dna simple substitution model allows one calculate expected site pattern frequencies tree topology branch lengths given four taxa unrooted bifurcating tree five branch lengths substitution models also make possible simulate sequence data using monte carlo methods simulated multiple sequence alignments used assess performance phylogenetic generate null distribution certain statistical tests fields molecular evolution molecular phylogenetics examples tests include tests model sowh test used examine tree fact substitution models used analyze biological alphabet made possible develop models evolution phenotypic eg morphological behavioural traits typically used indicate absence trait used indicate presence trait although also possible score characters using multiple states using framework might encode set phenotypes binary strings could generalized kstate strings characters two states analyses using appropriate mode illustrated using toy example use binary alphabet score following phenotypic traits feathers lays eggs fur warmblooded capable powered flight toy example hummingbirds would sequence birds would string ostriches would sequence cattle land mammals would bats would likelihood phylogenetic tree calculated using binary sequences appropriate substitution model existence morphological models make possible analyze data matrices fossil taxa either using morphological data combination morphological molecular latter scored missing data fossil taxa obvious similarity use molecular phenotypic data field cladistics analyses morphological characters using substitution model however vociferous debatea systematics community regarding question whether cladistic analyses viewed modelfree field cladistics defined strictest sense favor use maximum parsimony criterion phylogenetic many cladists reject position maximum parsimony based substitution model many cases justify use parsimony using philosophy karl however existence parsimonyequivalent ie substitution models yield maximum parsimony tree used analyses makes possible view parsimony substitution typically branch length phylogenetic tree expressed expected number substitutions per site evolutionary model indicates site within ancestral sequence typically experience x substitutions time evolves particular descendants sequence ancestor descendant considered separated branch length x sometimes branch length measured terms geological years example fossil record may make possible determine number years ancestral species descendant species species evolve faster rates others two measures branch length always direct proportion expected number substitutions per site per year often indicated greek letter mu μ model said strict molecular clock expected number substitutions per year μ constant regardless species evolution examined important implication strict molecular clock number expected substitutions ancestral species presentday descendants must independent descendant species examined note assumption strict molecular clock often unrealistic especially across long periods evolution example even though rodents genetically similar primates undergone much higher number substitutions estimated time since divergence regions could due shorter generation higher metabolic rate increased population structuring increased rate speciation smaller body studying ancient events like cambrian explosion molecular clock assumption poor concurrence cladistic phylogenetic data often observed work models allowing variable rate models take account variability rate molecular clock different evolutionary lineages phylogeny called relaxed opposition strict models rate assumed correlated ancestors descendants rate variation among lineages drawn many distributions usually exponential lognormal distributions applied special case called local molecular clock phylogeny divided least two partitions sets lineages strict molecular clock applied different rates many useful substitution models timereversible terms mathematics model care sequence ancestor descendant long parameters number substitutions per site expected two sequences held constant analysis real biological data performed generally access sequences ancestral species presentday species however model timereversible species ancestral species irrelevant instead phylogenetic tree rooted using species rerooted later based new knowledge left unrooted special species species eventually derive one another probability model time reversible satisfies property notation explained equivalently detailed balance property every j timereversibility confused stationarity model stationary q change time analysis assumes stationary model stationary neutral independent finite sites models assuming constant rate evolution two parameters π equilibrium vector base character frequencies rate matrix q describes rate bases one type change bases another type element q j displaystyle qij j rate base goes base j diagonals q matrix chosen rows sum zero equilibrium row vector π must annihilated rate matrix q transition matrix function function branch lengths units time possibly substitutions matrix conditional probabilities denoted p displaystyle pt entry ith column jth row p j displaystyle pijt probability time base j given position conditional base position time model time reversible performed two sequences even one ancestor know total branch length asymptotic properties pijt δij δij kronecker delta function change base composition sequence extreme lim p j π j displaystyle lim trightarrow infty pijtpi j words time goes infinity probability finding base j position given base position originally goes equilibrium probability base j position regardless original base furthermore follows π p π displaystyle pi ptpi transition matrix computed rate matrix via matrix exponentiation qn matrix q multiplied enough times give nth power q diagonalizable matrix exponential computed directly let q λ u diagonalization q λ diagonal matrix λ displaystyle lbrace lambda irbrace eigenvalues q repeated according multiplicity diagonal matrix eλt given generalised time reversible gtr general neutral independent finitesites timereversible model possible first described general form simon tavaré gtr model often called general time reversible model also called rev gtr parameters nucleotides consist equilibrium base frequency vector π π π π π displaystyle vec pi pi giving frequency base occurs site rate matrix model must time reversible must approach equilibrium nucleotide base frequencies long times rate diagonal equals reciprocal rate diagonal multiplied equilibrium ratio two bases nucleotide gtr requires substitution rate parameters equilibrium base frequency parameters since frequency parameters must sum free frequency parameters total free parameters often reduced parameters plus μ displaystyle mu overall number substitutions per unit time measuring time substitutions μ displaystyle mu free parameters remain general compute number parameters count number entries diagonal matrix ie n trait values per site n n displaystyle add equilibrium frequencies subtract μ displaystyle mu fixed get example amino acid sequence standard amino acids make proteins would find parameters however studying coding regions genome common work codon substitution model codon three bases codes one amino acid protein displaystyle codons resulting free parameters however rates transitions codons differ one base often assumed zero reducing number free parameters displaystyle parameters another common practice reduce number codons forbidding stop nonsense codons biologically reasonable assumption including stop codons would mean one calculating probability finding sense codon j displaystyle j time displaystyle given ancestral codon displaystyle would involve possibility passing state premature stop codon alternative commonly way write instantaneous rate matrix q displaystyle q matrix nucleotide gtr model q π c b π g c π π c b π g c π π π π g e π π g e π b π π c b π π c f π f π c π e π c f π g c π e π c f π g displaystyle qbeginpmatrixapi cbpi gcpi tapi cbpi gcpi tapi aapi adpi gepi tdpi gepi tbpi adpi cbpi adpi cfpi tfpi tcpi aepi cfpi gcpi aepi cfpi gendpmatrix q displaystyle q matrix normalized k π q displaystyle sum notation easier understand notation originally used tavaré model parameters correspond either exchangeability parameters displaystyle f displaystyle f also written using notation r j displaystyle rij equilibrium nucleotide frequencies π π π c π g π displaystyle vec pi pi api cpi gpi note nucleotides q displaystyle q matrix written alphabetical order words transition probability matrix q displaystyle q matrix would p e q p p c p g p p c p c c p c g p c p g p g c p g g p g p p c p g p displaystyle pteqtbeginpmatrixpmathrm aa tpmathrm ac tpmathrm ag tpmathrm tpmathrm ca tpmathrm cc tpmathrm cg tpmathrm ct tpmathrm ga tpmathrm gc tpmathrm gg tpmathrm gt tpmathrm ta tpmathrm tc tpmathrm tg tpmathrm tt tendpmatrix publications write nucleotides different order eg authors choose group two purines together two pyrimidines together see also models dna evolution difference notation make important clear regarding order states writing q displaystyle q matrix value notation instantaneous rate change nucleotide displaystyle nucleotide j displaystyle j always written r j π j displaystyle rijpi j r j displaystyle rij exchangeability nucleotides displaystyle j displaystyle j π j displaystyle pi j equilibrium frequency j h displaystyle jth nucleotide matrix shown uses letters displaystyle f displaystyle f exchangeability parameters interest readability parameters could also written systematic manner using r j displaystyle rij notation eg r c displaystyle arac b r g displaystyle brag forth note ordering nucleotide subscripts exchangeability parameters irrelevant eg r c r c displaystyle racrca transition probability matrix values ie p c displaystyle pmathrm ac probability observing sequence c sequence evolutionary distance sequences displaystyle whereas p c displaystyle pmathrm ca probability observing c sequence sequence evolutionary distance arbitrarily chosen exchangeability parameters eg f r g displaystyle frgt typically set value increase readability exchangeability parameter estimates since allows users express values relative chosen exchangeability parameter practice expressing exchangeability parameters relative terms problematic q displaystyle q matrix normalized normalization allows displaystyle time matrix exponentiation p e q displaystyle pteqt expressed units expected substitutions per site standard practice molecular phylogenetics equivalent statement one setting mutation rate μ displaystyle mu reducing number free parameters eight specifically five free exchangeability parameters displaystyle e displaystyle e expressed relative fixed f r g displaystyle example three equilibrium base frequency parameters described three π displaystyle pi values need specified π displaystyle vec pi must sum alternative notation also makes easier understand submodels gtr model simply correspond cases exchangeability andor equilibrium base frequency parameters constrained take equal values number specific submodels named largely based original publications possible ways exchangeability parameters restricted form submodels ranging models exchangeability parameters equal model full model exchangeability parameters free equilibrium base frequencies typically treated two different ways π displaystyle pi values constrained equal ie π π c π g π displaystyle pi api cpi gpi π displaystyle pi values treated free parameters although equilibrium base frequencies constrained ways constraints link π displaystyle pi values unrealistic biological standpoint possible exception enforcing strand ie constraining π π displaystyle pi api π c π g displaystyle pi cpi g allowing π π π c π g displaystyle pi api tneq pi cpi g alternative notation also makes straightforward see gtr model applied biological alphabets larger statespace eg amino acids codons possible write set equilibrium state frequencies π displaystyle pi π displaystyle pi π k displaystyle pi k set exchangeability parameters r j displaystyle rij alphabet k displaystyle k character states values used populate q displaystyle q matrix setting offdiagonal elements shown general notation would q j r j π j displaystyle qijrijpi j setting diagonal elements q displaystyle qii negative sum offdiagonal elements row normalizing obviously k displaystyle amino acids k displaystyle codons assuming standard genetic code however generality notation beneficial one use reduced alphabets amino acids example one use k displaystyle encode amino acids recoding amino acids using six categories proposed margaret dayhoff reduced amino acid alphabets viewed way reduce impact compositional variation main difference evolutionary models many parameters estimated every time data set consideration many estimated large data set mechanistic models describe substitutions function number parameters estimated every data set analyzed preferably using maximum likelihood advantage model adjusted particularities specific data set eg different composition biases dna problems arise many parameters used particularly compensate lead often case data set small yield enough information estimate parameters accurately empirical models created estimating many parameters typically entries rate matrix well character frequencies see gtr model large data set parameters fixed reused every data set advantage parameters estimated accurately normally possible estimate entries substitution matrix current data set downside parameters estimated training data might generic therefore poor fit particular dataset potential solution problem estimate parameters data using maximum likelihood method studies protein evolution equilibrium amino acid frequencies π π π r π n π v displaystyle vec pi pi api rpi npi v using oneletter iupac codes amino acids indicate equilibrium frequencies often estimated keeping exchangeability matrix fixed beyond common practice estimating amino acid frequencies data methods estimate exchangeability adjust q displaystyle q protein evolution ways proposed largescale genome sequencing still producing large amounts dna protein sequences enough data available create empirical models number parameters including empirical codon problems mentioned two approaches often combined estimating parameters largescale data remaining parameters adjusted data set consideration following sections give overview different approaches taken dna protein codonbased models first models dna evolution proposed jukes jukescantor jc model assumes equal transition rates well equal equilibrium frequencies bases simplest submodel gtr model motoo kimura introduced model two parameters one transition one transversion rate year later kimura introduced second model three substitution types one transition rate one rate transversions conserve strongweak properties nucleotides displaystyle aleftrightarrow c g displaystyle cleftrightarrow g designated β displaystyle beta one rate transversions conserve aminoketo properties nucleotides c displaystyle aleftrightarrow c g displaystyle gleftrightarrow designated γ displaystyle gamma joseph felsenstein proposed fourparameter model substitution rate corresponds equilibrium frequency target nucleotide hasegawa kishino yano unified two last models fiveparameter model pioneering efforts many additional submodels gtr model introduced literature common use models move beyond gtr model specific ways also developed refined several almost dna substitution models mechanistic models described small number parameters one needs estimate models makes feasible estimate parameters data also necessary patterns dna sequence evolution often differ among organisms among genes within organisms later may reflect optimization action selection specific purposes eg fast expression messenger rna stability might reflect neutral variation patterns substitution thus depending organism type gene likely necessary adjust model circumstances alternative way analyze dna sequence data recode nucleotides purines r pyrimidines practice often called insertions deletions multiple sequence alignments also encoded binary analyzed using twostate simplest twostate model sequence evolution called cavenderfarris model cavenderfarrisneyman cfn model name model reflects fact described independently several different cfn model identical jukescantor model adapted two states even implemented model popular iqtree software package using model iqtree requires coding data rather r popular paup software package interpret data matrix comprising r data analyzed using cfn model also straightforward analyze binary data using phylogenetic hadamard alternative twostate model allows equilibrium frequency parameters r take values adding single free parameter model variously called iqtree many analyses particularly longer evolutionary distances evolution modeled amino acid since dna substitution also alter encoded amino acid information lost looking amino acids instead nucleotide bases however several advantages speak favor using amino acid information dna much inclined show compositional bias amino acids positions dna evolve speed nonsynonymous mutations less likely become fixed population synonymous ones probably important fast evolving positions limited alphabet size four possible states dna suffers back substitutions making difficult accurately estimate evolutionary longer distances unlike dna models amino acid models traditionally empirical models pioneered dayhoff coworkers estimating replacement rates protein alignments least identity originally limited ultimately culminating dayhoff pam model minimized chances observing multiple substitutions site estimated rate matrix series replacement probability matrices derived known names logodds matrices based dayhoff pam model commonly used assess significance homology search results although blosum superseded pam logodds matrices context blosum matrices appear sensitive across variety evolutionary distances unlike pam logodds dayhoff pam matrix source exchangeability parameters used one first maximumlikelihood analyses phylogeny used protein pam model improved version pam model called continues used phylogenetics however limited number alignments used generate pam model reflecting limited amount sequence data available almost certainly inflated variance rate matrix parameters alternatively proteins used generate pam model could nonrepresentative set regardless clear pam model seldom good fit datasets modern empirical models keane et al tested thousands vertebrate bacterial archaeal proteins found dayhoff pam model bestfit proteins starting rapid expansion sequence databases due improved sequencing technologies led estimation many new empirical matrices see complete list earliest efforts used methods similar used dayhoff using largescale matching protein database generate new logodds jtt jonestaylorthornton rapid increases compute power time reflecting factors moores law made feasible estimate parameters empirical models using maximum likelihood eg models methods eg models iqtree software package allows users infer time reversible model using nontimereversible using another set substitution models protein evolution directly incorporate information protein structure provide realistic modeling terms likelihood biological tuffley described model named common mechanism ncm model topology maximum likelihood tree specific dataset given ncm model identical topology optimal tree data given maximum parsimony criterion ncm model assumes data eg homologous nucleotides amino acids morphological characters related common phylogenetic tree displaystyle parameters introduced homologous character displaystyle number sequences viewed estimating separate rate parameter every character branch pair dataset note number branches fully resolved phylogenetic tree displaystyle thus number free parameters ncm model always exceeds number homologous characters data matrix ncm model criticized consistently httpsenwikipediaorgwikisubstitutionmodel